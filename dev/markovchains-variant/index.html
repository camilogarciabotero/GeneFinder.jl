<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A variant test ¬∑ GeneFinder.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://camilogarciabotero.github.io/GeneFinder.jl/markovchains-variant/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeneFinder.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../simplefinder/">Finding ORFs</a></li><li><a class="tocitem" href="../markovchains/">Towards Markov Chains</a></li><li class="is-active"><a class="tocitem" href>A variant test</a><ul class="internal"><li><a class="tocitem" href="#Transition-models-with-BioSequences"><span>Transition models with BioSequences</span></a></li><li><a class="tocitem" href="#The-*log-odds-ratio*-decision-rule"><span>The <em>log-odds ratio</em> decision rule</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>A variant test</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A variant test</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/camilogarciabotero/GeneFinder.jl/blob/main/docs/src/markovchains-variant.md#" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DNA-as-a-Markov-chain"><a class="docs-heading-anchor" href="#DNA-as-a-Markov-chain">DNA as a Markov chain</a><a id="DNA-as-a-Markov-chain-1"></a><a class="docs-heading-anchor-permalink" href="#DNA-as-a-Markov-chain" title="Permalink"></a></h1><p>Several packages (e.g.¬†<a href=".">MarkovChainsHammer</a>, <a href=".">Markovians</a>, etc.) in the Julia ecosystem have been implemented to work with Markov chains with a <em>state space</em> of integers, those could be efficient in many ways, but they are clumsy to work with a specialized biological types as in the <code>BioJulia</code> ecosystem. Therefore, in the <code>GeneFinder</code> package we dedicated some implementations to work with <code>BioSequence</code> types so that we can expand the functionality in an efficient way (see complete <a href=".">API</a>).</p><p>One important step towards many gene finding algorithms is to represent a DNA sequence as a Markov chain. In this representation a DNA sequence of a reduced alphabet ùíú‚ÄÑ=‚ÄÑ{<em>A</em>,‚ÄÜ<em>C</em>,‚ÄÜ<em>G</em>,‚ÄÜ<em>T</em>} is draw as a four-vertex graph, where each letter of ùíú is a <em>state (vertex)</em> and the edges of the graph represent <em>transitions</em> from one nucleotide to another in a sequence (e.g.¬†<em>A</em>‚ÄÑ‚Üí‚ÄÑ<em>T</em> represent a single nucleotide to nucleotide transition). This is also considered more specifically as a Discrete Markov chain (Axelson-Fisk 2015). The complete set of transitions and states of a DNA sequence of alphabet ùíú.</p><p><img src="/docs/assets/nucleotide-markov-chain.png" alt="DNA sequence as a Markov chain"/></p><p>More formally a Markov chain is a random process where each state is a random variable <em>X</em>&lt;sub&gt;<em>t</em>&lt;/sub&gt; where <code>t \in T</code> is a discrete time in a finite sequence <em>T</em> and the probability to jump from one state into another is <em>only dependent of the current state.</em> Therefore a definition of this <em>Markov property</em> is given by:</p><p class="math-container">\[\begin{align}
P(X_{t} = j |X_{t‚àí1} = i)
\end{align}\]</p><p>where <em>i</em>,‚ÄÜ<em>j</em>‚ÄÑ‚àà‚ÄÑùíú . This property led us to generalize a way to calculate the probability of a sequence <em>T</em> from a process <code>(X_{1}...X_{T})</code> where each random variable is a nucleotide from ùíú so that:</p><p class="math-container">\[\begin{align}
P(X_{1} = i_{1},...,X_{T} = i_{T}) = P(X_{1} = i_{1}) \prod_{t=2}^{T} P(X_{t} = i_{t} | X_{t‚àí1} = i_{t‚àí1})
\end{align}\]</p><p>Note that previous equations has two terms, a initial probability <code>P(X_{1} = i_{1})</code> and the the product of all transitions beginning at <code>t=2</code>. So, to calculate the initial probability distribution of each of the nucleotides of a string <span>$T$</span> with the alphabet ùíú we can first calculate the transition probability matrix ‚Ñ≥ÃÇ out of the frequency count of the transitions. In an alphabet ùíú we got 4&lt;sup&gt;2&lt;/sup&gt; transitions of one order, that is the <em>A**A</em>,‚ÄÜ<em>A**C</em>,‚ÄÜ<em>A**G</em>,‚ÄÜ... which coincides with the frequency of the dinucleotides in the sequence. So we can later in fact build a 4<em>x</em>4 matrix representing all the transitions. For instance in a DNA sequence <em>T</em> of 24 nucleotides:  </p><p class="math-container">\[CCTCCCGGACCCTGGGCTCGGGAC\]</p><p>We can calculate each frequency nucleotide to any other nucleotide <span>$\widehat{m}\_{ij} = \frac{c\_{ij}}{c\_{i}}$</span> where <em>c</em>&lt;sub&gt;<em>i**j</em>&lt;/sub&gt; is the actual count of the dinucleotide, and therefore <em>c</em>&lt;sub&gt;<em>i</em>&lt;/sub&gt; is the counts of the nucleotide <em>i</em> to any other nucleotide and build the transition probability matrix:</p><p class="math-container">\[\begin{bmatrix}
   &amp; \text{A} &amp; \text{C} &amp; \text{G} &amp; \text{T} \\
\text{A} &amp; 0.00 &amp; 1.00 &amp; 0.00 &amp; 0.00 \\
\text{C} &amp; 0.00 &amp; 0.56 &amp; 0.22 &amp; 0.30 \\
\text{G} &amp; 0.25 &amp; 0.12 &amp; 0.62 &amp; 0.00 \\
\text{T} &amp; 0.00 &amp; 0.67 &amp; 0.33 &amp; 0.00 \\
\end{bmatrix}\]</p><p>It is noteworthy that initial probabilities can also be obtained from the counts of each nucleotide transitions <em>c</em>&lt;sub&gt;<em>i**j</em>&lt;/sub&gt; over the total sum of the dinucleotide counts <em>c</em>&lt;sub&gt;<em>k</em>&lt;/sub&gt; :</p><p class="math-container">\[\widehat{\pi}_{i} = \frac{c_{i}}{\sum_{k}c_{k}}\]</p><p>That way for the previous example example we can can calculate the initial probabilities <em>œÄÃÇ</em>‚ÄÑ=‚ÄÑ(0.08,0.43,0.34,0.13). Both set of probabilities composed a <em>transition model</em> that can be used to predict the probability of any DNA sequence using equation (2).</p><h2 id="Transition-models-with-BioSequences"><a class="docs-heading-anchor" href="#Transition-models-with-BioSequences">Transition models with BioSequences</a><a id="Transition-models-with-BioSequences-1"></a><a class="docs-heading-anchor-permalink" href="#Transition-models-with-BioSequences" title="Permalink"></a></h2><p>We can now calculate a transition probability matrix from a <code>LongDNA</code> sequence using the <code>transition_probability_matrix</code> and <code>initial_distribution</code> methods for a given <code>LongDNA</code> sequence:</p><pre><code class="language-julia hljs">using BioSequences, GeneFinder

sequence = dna&quot;CCTCCCGGACCCTGGGCTCGGGAC&quot;

tpm = transition_probability_matrix(sequence)
initials = initial_distribution(sequence)

println(tpm)
println(initials)</code></pre><pre><code class="nohighlight hljs">TPM{Dict{DNA, Int64}, Matrix{Float64}:
   A     C     G     T     
A  0.0   1.0   0.0   0.0   
C  0.0   0.5   0.2   0.3   
G  0.25  0.125 0.625 0.0   
T  0.0   0.667 0.333 0.0   

[0.08695652173913043 0.43478260869565216 0.34782608695652173 0.13043478260869565]</code></pre><p>More conveniently, we can now use the <code>transition_model</code> method and obtain the transition probabilities and the initial distribution and build a transition model:</p><pre><code class="language-julia hljs">transition_model(sequence)</code></pre><pre><code class="nohighlight hljs">TransitionModel:
  - Transition Probability Matrix (Size: 4 √ó 4):
    0.0 1.0 0.0 0.0 
    0.0 0.5 0.2 0.3 
    0.25    0.125   0.625   0.0 
    0.0 0.667   0.333   0.0 
  - Initials (Size: 1 √ó 4):
    0.087   0.435   0.348   0.13    
  - order: 1</code></pre><p>Note that, sometimes the dinucleotides transition do not harbor important biological meaning, whereas trinucleotides or codons are, in fact, the building block of proteins. Therefore, sometimes the transition model we want to build is usually a second-order Markov chain, that represents the possible transitions of a trinucleotide.</p><p>A very nice nice property of the transition probability matrix is that the <em>n-step transition probability matrix</em> <span>$^{n} = (\_{ij}(n))$</span>, that is the <em>n</em> th power of ‚Ñ≥ represents <em>i</em>‚ÄÑ‚Üí‚ÄÑ<em>j</em> transitions in <em>n</em> steps. We can also have higher order transition models as:</p><pre><code class="language-julia hljs">transition_model(sequence, 2)</code></pre><pre><code class="nohighlight hljs">TransitionModel:
  - Transition Probability Matrix (Size: 4 √ó 4):
    0.0 0.5 0.2 0.3 
    0.05    0.475   0.325   0.15    
    0.156   0.391   0.416   0.038   
    0.083   0.375   0.342   0.2 
  - Initials (Size: 1 √ó 4):
    0.087   0.435   0.348   0.13    
  - order: 2</code></pre><h2 id="The-*log-odds-ratio*-decision-rule"><a class="docs-heading-anchor" href="#The-*log-odds-ratio*-decision-rule">The <em>log-odds ratio</em> decision rule</a><a id="The-*log-odds-ratio*-decision-rule-1"></a><a class="docs-heading-anchor-permalink" href="#The-*log-odds-ratio*-decision-rule" title="Permalink"></a></h2><p>The sequence probability given a transition probability model (eq. 2) could be used as the source of a sequence classification based on a decision rule to classify whether a sequence correspond to a model or another. Now, imagine we got two DNA sequence transition models, a CDS model and a No-CDS model. The <em>log-odds ratio</em> decision rule could be establish as:</p><p class="math-container">\[\begin{align}
S(X) = \log \frac{{P_C(X_1=i_1, \ldots, X_T=i_T)}}{{P_N(X_1=i_1, \ldots, X_T=i_T)}}  \begin{cases} &gt; \eta &amp; \Rightarrow \text{coding} \\ &lt; \eta &amp; \Rightarrow \text{noncoding} \end{cases}
\end{align}\]</p><p>Where the <em>P</em>&lt;sub&gt;<em>C</em>&lt;/sub&gt; is the probability of the sequence given a CDS model, <em>P</em>&lt;sub&gt;<em>N</em>&lt;/sub&gt; is the probability of the sequence given a No-CDS model, the decision rule is finally based on whether the ratio is greater or lesser than a given threshold <em>Œ∑</em> of significance level.</p><p>In the GeneFinder we have implemented this rule and a couple of basic transition probability models of CDS and No-CDS of <em>E. coli</em> from Axelson-Fisk (2015) work. To check whether a random sequence could be coding based on these decision we use the predicate <code>iscoding</code> with the <code>ECOLICDS</code> and <code>ECOLINOCDS</code> models:</p><pre><code class="language-julia hljs">randseq = getcds(randdnaseq(99))[1] # this will retrieved a random coding ORF

iscoding(randseq, ECOLICDS, ECOLINOCDS)</code></pre><pre><code class="nohighlight hljs">false</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>Axelson-Fisk, Marina. 2015. <em>Comparative Gene Finding</em>. Vol. 20. Computational Biology. London: Springer London. <a href="http://link.springer.com/10.1007/978-1-4471-6693-1">http://link.springer.com/10.1007/978-1-4471-6693-1</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../markovchains/">¬´ Towards Markov Chains</a><a class="docs-footer-nextpage" href="../api/">API ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 3 July 2023 22:07">Monday 3 July 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
